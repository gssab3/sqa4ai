Introduzione

Questo cheat sheet offre indicazioni chiare per deserializzare in sicurezza dati non affidabili nelle applicazioni.
Serializzazione è il processo che trasforma un oggetto in un formato dati per conservarlo o trasmetterlo.
Deserializzazione è il processo inverso che ricostruisce oggetti da dati serializzati. I formati più comuni sono JSON e XML.

Attenzione: i meccanismi di deserializzazione nativi possono essere sfruttati per attacchi come negazione del servizio, bypass di controllo accessi o esecuzione remota di codice.

Guida per deserializzare in sicurezza:
PHP - Evitare la funzione unserialize() con dati esterni; preferire formati sicuri come JSON con json_decode().

Python:
- L’uso di pickle.loads() e yaml.load() su dati non fidati può essere pericoloso.
- Controllare l’encoding, ad esempio dati Base64 iniziano spesso con "gASV".

Java:
- Sovrascrivere ObjectInputStream#resolveClass() per autorizzare solo classi sicure alla deserializzazione.
- Dichiarare transient i dati sensibili per non serializzarli.
- Implementare readObject() che lancia eccezioni per bloccare deserializzazioni indesiderate.
- Usare librerie sicure e configurazioni di hardening.

.NET CSharp:
- Non usare BinaryFormatter, considerato insicuro.
- Usare binding controllati per evitare che dati utente definiscano i tipi deserializzati.
- Limitare la deserializzazione a tipi sicuri.
- Metodi generici per la sicurezza
- Preferire l’uso di formati dati puri come JSON o XML.
- Deserializzare solo dati firmati e autenticati.

Strumenti di mitigazione e rilevamento

    Utilizzare librerie di hardening per Java e .NET.

    Usare strumenti di testing e analisi statica per identificare vulnerabilità di deserializzazione.