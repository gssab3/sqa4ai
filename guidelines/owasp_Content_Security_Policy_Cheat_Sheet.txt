Introduction

Content Security Policy (CSP) is a W3C standard that allows you to specify from which origins (scripts, images, styles, etc.) the browser is allowed to load resources. It acts as a layered defense, primarily useful for countering XSS and clickjacking attacks, reducing the impact of untrusted code. CSP can also help ensure that resources are loaded over HTTPS and provide visibility into violations through reporting systems.

Problems / Causes

    Malicious script injection (XSS) executed despite other preventative measures.

    Clickjacking or client-side technical specifications bypassed due to lack of iframe control.

    High risk from loading resources from untrusted sources.

    Lack of a centralized policy; the site becomes vulnerable to compromised or malicious resources.

What to Do / How to Prevent

    Define and send a Content Security Policy via HTTP header that applies to all responses, not just the home page.

    Use clear directives such as script-src, object-src, img-src, and frame-ancestors to limit loaded resources and prevent framing (replacing X-Frame-Options).

    Adopt an initial "report-only" mode (CSP-Report-Only) to monitor for violations without taking down the production site.

    Apply nonces or hashes to improve security when loading dynamic scripts.

    Integrate CSP as an additional layer, not the only one: continue to follow best practices to prevent XSS (e.g., proper input validation).